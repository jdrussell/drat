---
title: "Drat Basics for Package Authors"
author: "Dirk Eddelbuettel"
date: "2015-04-08"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

## Drat Overview

The [drat](http://dirk.eddelbuettel.com/code/drat.html) package makes it trivially easy to deploy package repositories.  There are essentially just two ways to use 
package repository:

1) You write to the repository as a _package author_ to publish your package; or
1) You read from the reposiory as a _package user_ to install or update one or more packages.

This vignette deals with the first case:  How to use [drat](http://dirk.eddelbuettel.com/code/drat.html)

## As A Package Author

### Case 1: Using GitHub

#### GitHub as a Web Presence

The core motivation for [drat](http://dirk.eddelbuettel.com/code/drat.html) comes from [GitHub](http://github.com).  As you may know, _any_ GitHub user (or organization) can enable a website for a given repository.  At it takes is to create a [git branch](http://git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging) named `gh-pages`.  After that, a website is automatically visible. 

To make this more explicit, consider a hypothetical user John with account `johndoe`. Once John creates a repo `foo` and in it a branch `gh-pages`, he will have a web address `http://johndoe.github.io/foo`.

More formally, for a user `USER`, and a given repo named `drat`, we can always assume `http://USER.github.io/drat`.

So for you as a package author with a given GitHub account, all that is needed is a repository named `drat` with a `gh-pages` branch.  If you are familiar with `git` at the command-line, you can just create the branch (and the `src/contrib/ directory structure in it; see below).  

If you are less familiar with git, a really easy shortcut is to just [fork](https://help.github.com/articles/fork-a-repo/) the actual 
[drat](http://dirk.eddelbuettel.com/code/drat.html) repo.  It contains the drat source code which you could keep, or remove.  The fork only serves to set up the required `gh-pages` branch, and the `src/contrib/` directory.

#### Place Files into the Local Repo

We can now assume that you have a local git repository named `drat` with a subdirectory `src` containing a further subdirectory `contrib`.  You are now ready to insert a package into it.  For simplicit, let us assume the package is named `myPkg` and is at version 0.5. So `R CMD build` created a file `myPkg_0.5.tar.gz`.

Then via

```{r, eval=FALSE}
## insert given package into default drat repo on local file system
drat::insertPackage("myPkg_0.5.tar.gz")
```

the source package will be copied into the default drat repo at location `~/git/drat`. Should you git repos live in a different place, just specify this either via the `options()` entry "dratRepo" or directly:

```{r, eval=FALSE}
## insert given package into given repo on local file system
drat::insertPackage("myPkg_0.5.tar.gz", "/srv/projects/git/drat")
```

In either case, the package will be copied into the repo, and the PACKAGES file will be updated.

Lastly, if you have `git` (the command-line tool) or the wicked [git2r](http://cran.r-project.org/web/packages/git2r/index.html) package installed, then you can also use the `commit=TRUE` option to have the new files added and committed.

